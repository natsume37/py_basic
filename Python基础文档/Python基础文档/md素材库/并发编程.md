# 并发编程

## 并发编程分类：

- 单线程(串行)
- 多线程并发
- 多进程并行
- 异步开发

<img src="C:\Users\19570\Desktop\md素材库\并发编程图解.png" width=700>

<img src="C:\Users\19570\Desktop\md素材库\关系图.png" width=700>

## 问题引入：GLI锁

---

## 单线程串行

正常模式的开发

## 多线程

通过改变执行方式，来提高CPU利用率，避免了IO操作所浪费的时间

### 模块：threading

```python
# 导入
import theading

# 创建theading对象
threads = []
    for url in urls:
        threads.append(
            threading.Thread(target=car_w, args=(url,))
        )
        
# 线程程开始
    for thread in threads:
        thread.start()
    # 线程等待结束
    for thread in threads:
        thread.join()
```

**案例：**

```py
import time
import threading

import requests

urls = [
    f'https://www.cnblogs.com/#{i}'
    for i in range(1, 50 + 1)
]


def craw(url):
    res = requests.get(url)
    print(res.status_code, len(res.text))


# 单线程爬取
def single_thread(url_list):
    print('single_thread begin')
    for url in urls:
        craw(url)
    print('single_thread began')


# 多线程爬取
def multi_thread(url_list):
    print('multi_thread begin')
    threads = []
    for url in urls:
        threads.append(
            threading.Thread(target=craw, args=(url,))
        )
    # 线程程开始
    for thread in threads:
        thread.start()
    # 线程等待结束
    for thread in threads:
        thread.join()

    print('multi_thread began')


single_thread_start = time.time()
single_thread(urls)
single_thread_end = time.time()

multi_thread_start = time.time()
multi_thread(urls)
multi_thread_end = time.time()

print(f'single_thread {single_thread_end - single_thread_start}')
print(f'multi_thread {multi_thread_end - multi_thread_start}')

# Result
# single_thread 15.876798868179321
# multi_thread 0.732025146484375
```

### 多线程数据通信模块：queue.Queue

可以用于多线程之间的、**线程安全**的数据通信

```pyth
# 导入
import queue

# 创建Queue
q = queue.Queue

# 添加元素
q.put(item)

# 获取元素
item = q.get()

# 查询状态

# 产看元素多少
q.qsize()
# 判断是否为空
q.empty()
# 判断是否已满
q.full()
```







## 多进程

利用多核CPU的能力，真正意义上的并行

### 模块：multiprocessing



## 异步IO

在单线程CPU和IO同时执行的原理实现函数异步执行

### 模块：asyncio

